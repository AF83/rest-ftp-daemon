- count_all = $queue.jobs_count
- counts_by_status = $queue.counts_by_status
-# jobs_without_queue = jobs


%h2
  Jobs table &nbsp;

  .btn-group.btn-group-md
    - klass = only.empty? ? "btn-info" : ""
    %a.btn.btn-default{href: "?only=", class: klass}
      ALL (#{count_all})
  .btn-group.btn-group-md
    - counts_by_status.each do |status, count|
      - klass = (status.to_s == only) ? "btn-info" : ""
      %a.btn.btn-default{href: "?only=#{status}", class: klass}
        #{status} (#{count})

%table.table.table-striped.table-hover.table-condensed#jobs

  %thead
    %tr
      %th ID
      %th label
      %th source
      %th <=>
      %th target
      %th queued
      %th{width: 220} status
      %th{width: 150} error
      %th.text-right size
      %th.text-right bitrate
      %th info
      %th sort key


    - unless queue.empty?
      %tbody.jobs
        = render :dashboard_table, {jobs: queue.reverse}

        %thead
          %tr
            %td{colspan: 13}
              %br

    - unless current.empty?
      %tbody.jobs
        = render :dashboard_table, {jobs: current.reverse}
